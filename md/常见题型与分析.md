# 常见题型与分析

## 概述

本节内容基于**华中科技大学计算机科学与技术学院C语言程序设计期末考试**题型编写，主要包括：

1. 表达式求值

2. 程序/函数改错

3. 写表达式/函数/程序

4. 程序运行结果分析

5. 程序完善

## 1 表达式求值

表达式求值涉及的知识点主要包括**结构**与联合、数组、指针、运算符与优先级(包括位运算)，需要对优先级**特别敏感**，才会在运算时不会因惯性思维算出错误结果

### 例1

```c
(2019-2020期末)请根据下面的声明，计算表达式
short x=1,y=2,z=0x12ab;
char c1=4,c2=16;
int i=0,j=1;
(5)c2=-j^z,值为____
```

<font color=blue>解析</font>：<mark>变向考察类型转换</mark>。首先应了解计算机内部整数的存储，负数以补码形式存储，整数以原码形式存储。

```
-j原码:10000000 00000000 00000000 00000001
  反码:11111111 11111111 11111111 11111110
  补码:11111111 11111111 11111111 11111111
z 原码:                  00010010 10101011
  结果:                  11101101 01010100
```

但由于c2为`char`型，只取低八位，故c2=0x54。

### 例2

```c
(2016-2017期末)
char name1[10]={'C','H','A','R','L','E','S','\0'};
char name2[10]={'J','O','E','\0'};
struct student{
    char *name;
    float av;
    int rank;
}stu[2]={{name1,90.0,1},{name2,86.0,2}},*ps=stu;
(8)++*stu->name,值为______
```

<font color=blue>解析</font>：<font color=red>对优先级敏感</font>。对于`->,.,[]`等运算符，看到他们要有感性的认知，知道它们的优先级是最高的。这里先计算`stu->name`，结果为指向name1的指针，然后取`*`，结果为首字母值，即'C'，再做前缀自增，结果为'D'。

### 例3

```c
(2014-2015期末)
unsigned char c1=0xD4;    char C2=0x87;
unsigned int i1=0xFF;     int i2=0x1F00;
(4)~c2&0xf,值为_____
```

<font color=blue>解析</font>：依然是优先级。`&`与`~`的优先级相同，但结合性为右结合，从右到左算，先取且再取反，结果为8.

---

## 2 程序/函数改错

一般只会出现逻辑错误，当然对于复杂指针声明、带参宏定义等难点，编出一些错误语句也是有可能的。

### 例1

```c
(2019-2020期末)计算一维数组a的平均值并输出。下面程序输出为average:51.200000
#include<stdio.h>
#define N 10
int main(){
    int a[N]={10,20,60,45,70,18,90,100,66,33},i,sum=0;
    for(i=0;i<N;i++)    sum+=*a++;
    printf("average:%f",sum*1.0/N);//原题此处出错，未乘1.0
    return 0;
}
```

<font color=blue>解析</font>：这里就是典型的连编译都不通过。对于数组名做指针时，不能为其赋值而使其移动，这里*a++应改为a[i]。




